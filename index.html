<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>测试页面</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: white;
            background-image: url('https://gd-hbimg.huaban.com/a00e9e77f82f9b12375873003be4438da8804bfa115388-FRb2iy_fw1200webp');
            background-size: cover;
            background-position: center;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 80px;
            background-color: #3C6EF0;
            display: flex;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            z-index: 900;
        }
        /* 修改 .navbar button 样式 */
        .navbar button {
            width: 122px;
            height: 80px;
            background-color: #3C6EF0;
            color: #FFFFFF;
            font-size: 16px;
            line-height: 32px;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .navbar button:hover,
        .navbar button.selected {
            background-color: #325ECC;
            color: #FFFFFF;
        }

        .navbar button:last-child {
            margin-right: 0;
        }
        .content {
            padding-top: 80px;
            padding-left: 24px;
            padding-right: 24px;
        }
        .hidden {
            display: none;
        }
        .home-title {
            font-size: 32px;
            line-height: 48px;
            color: #333333;
            font-weight: 600;
            margin-left: 100px;
            margin-top: 80px;
        }
        .home-text {
            font-size: 16px;
            line-height: 24px;
            color: #484B60;
            max-width: 600px;
            margin-left: 100px;
            margin-top: 24px;
        }
        .contact-button {
            margin-top: 24px;
            margin-left: 100px;
            width: 142px;
            height: 42px;
            background-color: #F6F6F6;
            color: #333333;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            line-height: 32px;
            font-size: 16px;
            position: relative;
            padding-left: 28px;
            font-weight: 600;
            box-shadow: 0 0 1px 0 rgba(0,0,0,0.6), 0 38px 90px 0 rgba(0,0,0,0.25), 0 0 2px 0 rgba(0,0,0,0.05);
        }

        .contact-button::before {
            content: '';
            background: url('https://gd-hbimg.huaban.com/ef9376034be7992de44d306d1db437ef55e4726c75d5-gG3VPe_fw1200webp') no-repeat center center;
            background-size: contain;
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
        }

        
        .card1-button {
            display: block;
            width: 122px;
            height: 32px;
            background-color: #3C6EF0;
            color: #FFFFFF;
            font-size: 14px;
            line-height: 20px;
            border: none;
            border-radius: 8px;
            margin: 0 auto;
            cursor: pointer;
            text-align: center;
            position: absolute; /* 使按钮绝对定位 */
            top: 50%; /* 垂直居中 */
            left: 50%; /* 水平居中 */
            transform: translate(-50%, -50%); 
        }
        .card1 {
            position: absolute;
            top: calc(76px);
            left: 50%;
            width: 420px;
            background-color: #FFFFFF;
            box-shadow: 0 0 1px 0 rgba(0,0,0,0.6), 0 38px 90px 0 rgba(0,0,0,0.25), 0 0 2px 0 rgba(0,0,0,0.05);
            border-radius: 12px;
            padding: 16px 24px;
            opacity: 0;
            transform: translate(-50%, -50%)translateY(-20px);
            transition: opacity 0.2s ease-in-out, transform 0.2s ease-in-out;
            z-index: 1000;
        }
        .card1.show {
            opacity: 1;
            transform: translate(-50%, -50%)translateY(0);
        }
        .card1-icon {
            position: absolute;
            top: 50%;
            left: 24px;
            transform: translateY(-50%);
            width: 44px;
            height: 44px;
        }
        .card1-title {
            margin-left: 60px;
            margin-right: 16px;
            font-size: 20px;
            line-height: 24px;
            color: #333333;
            font-weight: 600;
        }
        .card1-text {
            margin-left: 60px;
            margin-top: 8px;
            font-size: 16px;
            line-height: 22px;
            color: #484B60;
        }
        
        .card1-close {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 16px;
            height: 16px;
            opacity: 0.7;
            cursor: pointer;    
        }
        .card2-button {
            display: block;
            width: 122px;
            height: 32px;
            background-color: #f03c3c;
            color: #FFFFFF;
            font-size: 14px;
            line-height: 20px;
            border: none;
            border-radius: 8px;
            margin: 0 auto;
            cursor: pointer;
            text-align: center;
            position: absolute; /* 使按钮绝对定位 */
            top: 50%; /* 垂直居中 */
            left: 50%; /* 水平居中 */
            transform: translate(-50%, -50%); 
        }
        .card2 {
            position: absolute;
            top: calc(80px);
            left: 50%;
            width: 510px;
            background-color: #FFFFFF;
            box-shadow: 0 0 1px 0 rgba(0,0,0,0.6), 0 38px 90px 0 rgba(0,0,0,0.25), 0 0 2px 0 rgba(0,0,0,0.05);
            border-radius: 12px;
            padding: 16px 24px;
            opacity: 0;
            transform: translate(-50%, -50%)translateY(-20px);
            transition: opacity 0.2s ease-in-out, transform 0.2s ease-in-out;
            z-index: 1000;
        }
        .card2.show {
            opacity: 1;
            transform: translate(-50%, -50%)translateY(0);
        }
        .card2-icon {
            position: absolute;
            top: 50%;
            left: 24px;
            transform: translateY(-50%);
            width: 44px;
            height: 44px;
        }
        .card2-title {
            margin-left: 60px;
            margin-right: 16px;
            font-size: 20px;
            line-height: 24px;
            color: #333333;
            font-weight: 600;
        }
        .card2-text {
            margin-left: 60px;
            margin-top: 8px;
            font-size: 20px;
            line-height: 30px;
            color: #484B60;
        }
        
        .card2-close {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 16px;
            height: 16px;
            opacity: 0.7;
            cursor: pointer;    
        }
        .button1 {
            width: 122px;
            height: 32px;
            background-color: #3C6EF0;
            color: #ffffff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            line-height: 32px;
            position: absolute; /* 使按钮绝对定位 */
            top: 50%; /* 垂直居中 */
            left: 50%; /* 水平居中 */
            transform: translate(-50%, -50%); 
            font-size: 14px;
        }
        .overlay1 {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            justify-content: center;
            align-items: center;
            
        }
        .overlay1.show {
            display: flex;
        }
        .popup1 {
            width: 560px;
            height: 236px;
            background-color: #FFFFFF;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding-top: 48px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        .popup1.show {
            display: flex;
        }
        .popup1 img {
            width: 44px;
            height: 44px;
        }
        .popup1 p {
            margin-top: 24px;
            width: 512px;
            text-align: center;
            font-size: 20px;
            line-height: 30px;
            font-weight: 600;
            word-wrap: break-word;
        }
        .popup1 .divider1 {
            position: absolute;
            bottom: 55px;
            width: 560px;
            height: 1px;
            background-color: #F1F2F4;
        }
        .popup1 .close-button1 {
            position: absolute;
            bottom: 12px;
            right: 24px;
            width: 82px;
            height: 32px;
            background-color: #3C6EF0;
            color: #ffffff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            line-height: 32px;
        }
        .button2 {
            position: absolute; /* 使按钮绝对定位 */
            top: 50%; /* 垂直居中 */
            left: 50%; /* 水平居中 */
            transform: translate(-50%, -50%); 
            width: 122px;
            height: 32px;
            background-color: #fc3737;
            color: #ffffff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            line-height: 32px;
            font-size: 14px;
        }
        .overlay2 {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            justify-content: center;
            align-items: center;
            
        }
        .overlay2.show {
            display: flex;
        }
        .popup2 {
            width: 560px;
            height: 238px;
            background-color: #FFFFFF;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding-top: 48px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        .popup2.show {
            display: flex;
        }
        .popup2 img {
            width: 44px;
            height: 44px;
        }
        .popup2 p {
            margin-top: 24px;
            width: 512px;
            text-align: center;
            font-size: 22px;
            line-height: 32px;
            font-weight: 600;
            word-wrap: break-word;
            letter-spacing: 1.5px;
        }
        .popup2 .divider2 {
            position: absolute;
            bottom: 55px;
            width: 560px;
            height: 1px;
            background-color: #F1F2F4;
        }
        .popup2 .close-button2 {
            position: absolute;
            bottom: 12px;
            right: 24px;
            width: 82px;
            height: 32px;
            background-color: #3C6EF0;
            color: #ffffff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            line-height: 32px;
        }
        .button3 {
            position: absolute; /* 使按钮绝对定位 */
            top: 50%; /* 垂直居中 */
            left: 50%; /* 水平居中 */
            transform: translate(-50%, -50%); 
            width: 122px;
            height: 32px;
            background-color: #3C6EF0;
            color: #ffffff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            line-height: 32px;
            font-size: 14px;
        }
        .overlay3 {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            justify-content: center;
            align-items: center;
            
        }
        .overlay3.show {
            display: flex;
        }
        .popup3 {
            width: 700px;
            height: 298px;
            background-color: #FFFFFF;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding-top: 48px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        .popup3.show {
            display: flex;
        }
        .popup3 img {
            width: 50px;
            height: 50px;
        }
        .popup3 p {
            margin-top: 24px;
            width: 652px;
            text-align: center;
            font-size: 29px;
            line-height: 44px;
            font-weight: 600;
            word-wrap: break-word;
            letter-spacing: 1.5px;
        }
        .popup3 .divider3 {
            position: absolute;
            bottom: 69px;
            width: 700px;
            height: 1px;
            background-color: #F1F2F4;
        }
        .popup3 .close-button3 {
            position: absolute;
            bottom: 16px;
            right: 24px;
            width: 116px;
            height: 38px;
            background-color: #3C6EF0;
            color: #ffffff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            line-height: 32px;
            font-size: 16px;
        }
        
        .export-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 100px;
            height: 40px;
            background-color: #3C6EF0;
            color: #FFFFFF;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            line-height: 40px;
            font-size: 14px;
        }
    </style>
     <script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script>
     <script type="text/javascript">
        (function(){
           emailjs.init("lAY_kx0jcaMpyg2OE");
        })();
     </script>
</head>
<body>
    <div class="navbar">
        <button onclick="showPage('home')">首页</button>
        <button onclick="showPage('card1')">卡片1测试</button>
        <button onclick="showPage('card2')">卡片2测试</button>
        <button onclick="showPage('popup1')">弹窗1测试</button>
        <button onclick="showPage('popup2')">弹窗2测试</button>
        <button onclick="showPage('popup3')">弹窗3测试</button>
        <button onclick="showPage('record')">操作记录</button>
    </div>

    <div id="home" class="content">
        <div class="home-title">感谢参与本次测试，您的意见对于我们至关重要</div>
        <div class="home-text">需要您分别点击顶部的4个测试按钮，并按照要求执行测试任务，测试完成后点击【操作记录-导出】将下载内容发送至【京ME“sangweijie3”】。</div>
        <button class="contact-button" onclick="window.location.href='timline://chat/?topin=sangweijie3'">点此联系我</button>
    </div>

    <div id="card1" class="content hidden">
        <button class="card1-button" onclick="showCard()">卡片1开始测试</button>
        <div id="card1-content" class="card1">
            <img src="https://gd-hbimg.huaban.com/f89d3a032f35d6fe3aedc73b746fc7fb19145a8c58ee-Eklz4G_fw1200" alt="警报" class="card1-icon">
            <div class="card1-title">请注意！</div>
            <div class="card1-text">序列号商品验收时，请提交序列号信息！</div>
            <img src="https://gd-hbimg.huaban.com/acd72e89bae5fe88591bdaf33a54e514fc42a09d2fc6-ODNMYl_fw1200webp" alt="关闭" class="card1-close" onclick="hideCard()">
        </div>
    </div>

    <div id="card2" class="content hidden">
        <button class="card2-button" onclick="showCard2()">卡片2开始测试</button>
        <div id="card2-content" class="card2">
            <img src="https://gd-hbimg.huaban.com/f89d3a032f35d6fe3aedc73b746fc7fb19145a8c58ee-Eklz4G_fw1200" alt="警报" class="card2-icon">
            <div class="card2-title">请注意！</div>
            <div class="card2-text">序列号商品验收时，请提交序列号信息！</div>
            <img src="https://gd-hbimg.huaban.com/acd72e89bae5fe88591bdaf33a54e514fc42a09d2fc6-ODNMYl_fw1200webp" alt="关闭" class="card2-close" onclick="hideCard2()">
        </div>
    </div>

    <div id="popup1" class="content hidden">
        <button class="button1" onclick="showPopup('overlay1')">弹窗1开始测试</button>
        <div class="overlay1" id="overlay1">
            <div class="popup1">
                <img src="https://gd-hbimg.huaban.com/e63917572b35b01f61caad0085855ffd2e17788775da-SoGx0n_fw1200webp" alt="Icon">
                <p>未匹配到生产单，不能进行差异登记/生产单不可复核，无需差异登记/无待复核商品，无需差异登记/当前生产单有未满的箱，是否继续登记差异？</p>
                <div class="divider1"></div>
                <button class="close-button1" onclick="hidePopup('overlay1')">我读完了</button>
            </div>
        </div>
    </div>

    <div id="popup2" class="content hidden">
        <button class="button2" onclick="showPopup('overlay2')">弹窗2开始测试</button>
        <div class="overlay2" id="overlay2">
            <div class="popup2">
                <img src="https://gd-hbimg.huaban.com/e63917572b35b01f61caad0085855ffd2e17788775da-SoGx0n_fw1200webp" alt="Icon">
                <p>序列号解析规则返回序列号长度为空或者冲突，请在配置管理-通用规则-序列号解析规则页面检查序列号解析规则是否配置正确！</p>
                <div class="divider2"></div>
                <button class="close-button2" onclick="hidePopup('overlay2')">我读完了</button>
            </div>
        </div>
    </div>

    <div id="popup3" class="content hidden">
        <button class="button3" onclick="showPopup('overlay3')">弹窗3开始测试</button>
        <div class="overlay3" id="overlay3">
            <div class="popup3">
                <img src="https://gd-hbimg.huaban.com/e63917572b35b01f61caad0085855ffd2e17788775da-SoGx0n_fw1200webp" alt="Icon">
                <p>此单要求只打一个包裹明细，所以只能装在一个箱子中，不允许中途满箱！【友情提示!!!】如果您操作缺量出库，请别忘了回来补满箱！</p>
                <div class="divider3"></div>
                <button class="close-button3" onclick="hidePopup('overlay3')">我读完了</button>
            </div>
        </div>
    </div>

    <div id="record" class="content hidden">
        <div class="home-title">操作记录</div>
        <div class="home-text">
            <ul id="record-list"></ul>
        </div>
        <button class="export-button" onclick="exportToExcel()">导出</button>
        <button class="export-button" style="right: 140px;" onclick="sendEmail()">一键发送</button>
    </div>

    <script>
        let records = [];
        let startTime = null;
    
        // 修改 showPage 函数
        function showPage(pageId) {
            const pages = document.querySelectorAll('.content');
            const buttons = document.querySelectorAll('.navbar button');
            pages.forEach(page => {
                if (page.id === pageId) {
                    page.classList.remove('hidden');
                } else {
                    page.classList.add('hidden');
                }
            });
            buttons.forEach(button => {
                if (button.getAttribute('onclick').includes(pageId)) {
                    button.classList.add('selected');
                } else {
                    button.classList.remove('selected');
                }
            });
        }

        // 默认显示首页并设置按钮选中状态
        document.addEventListener('DOMContentLoaded', () => {
            showPage('home');
            document.querySelector('.navbar button[onclick="showPage(\'home\')"]').classList.add('selected');
        });

    
        function showCard() {
            const card = document.getElementById('card1-content');
            card.style.visibility = 'visible';
            card.classList.add('show');
            startTime = new Date();
            logAction('卡片1测试开始');
        }
    
        function hideCard() {
            const card = document.getElementById('card1-content');
            card.classList.remove('show');
            card.style.visibility = 'hidden';
            const endTime = new Date();
            logAction('卡片1测试结束', endTime);
        }
    
        function showCard2() {
            const card = document.getElementById('card2-content');
            card.style.visibility = 'visible';
            card.classList.add('show');
            startTime = new Date();
            logAction('卡片2测试开始');
        }
    
        function hideCard2() {
            const card = document.getElementById('card2-content');
            card.classList.remove('show');
            card.style.visibility = 'hidden';
            const endTime = new Date();
            logAction('卡片2测试结束', endTime);
        }
    
        function showPopup(overlayId) {
            document.getElementById(overlayId).style.display = 'flex';
            startTime = new Date();
            logAction(`${overlayId} 弹窗测试开始`);
        }
    
        function hidePopup(overlayId) {
            document.getElementById(overlayId).style.display = 'none';
            const endTime = new Date();
            logAction(`${overlayId} 弹窗测试结束`, endTime);
        }
    
        function logAction(action, endTime = null) {
            const now = new Date();
            const date = now.toLocaleDateString();
            const time = now.toLocaleTimeString('zh-CN', { hour12: false }) + '.' + now.getMilliseconds();
            const logEntry = document.createElement('li');
            logEntry.textContent = `${date} ${time} - ${action}`;
            document.getElementById('record-list').appendChild(logEntry);
    
            if (endTime) {
                const duration = (endTime - startTime) / 1000; // 操作时长，单位为秒
                records.push({ date, time, action, duration });
            } else {
                records.push({ date, time, action, duration: null });
            }
        }
    
        function exportToExcel() {
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet([["操作日期", "操作时间", "操作项", "操作时长（秒）"]]);
            const recordsData = records.map(record => [record.date, record.time, record.action, record.duration]);
            XLSX.utils.sheet_add_aoa(ws, recordsData, { origin: -1 });
            XLSX.utils.book_append_sheet(wb, ws, "记录");
            XLSX.writeFile(wb, "操作记录.xlsx");
        }

        function sendEmail() {
        const wb = XLSX.utils.book_new();
        const ws = XLSX.utils.aoa_to_sheet([["操作日期", "操作时间", "操作项", "操作时长（秒）"]]);
        const recordsData = records.map(record => [record.date, record.time, record.action, record.duration]);
        XLSX.utils.sheet_add_aoa(ws, recordsData, { origin: -1 });
        XLSX.utils.book_append_sheet(wb, ws, "记录");

        const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'base64' });
        const attachment = `data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,${wbout}`;

        // 使用 EmailJS 服务发送邮件
        emailjs.send('service_ca9rq2p', 'template_ul2m9a9', {
            to_email: 'sangweijie3@jd.com',
            subject: 'WMS6.0测试记录',
            message: '附件内容为WMS6.0测试记录',
            attachment: attachment
        }).then(function(response) {
            alert('邮件发送成功！');
        }, function(error) {
            alert('邮件发送失败：' + JSON.stringify(error));
        });
    }


    
        // 默认显示首页
        showPage('home');
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
</body>
</html>
